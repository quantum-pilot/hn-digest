# Nx compromised: malware uses Claude code CLI to explore the filesystem

- Score: 493 | [HN](https://news.ycombinator.com/item?id=45038653) | Link: https://semgrep.dev/blog/2025/security-alert-nx-compromised-to-steal-wallets-and-credentials/

- TL;DR
  - Semgrep details a supply-chain attack on Nx: eight malicious releases (Aug 26) added a postinstall that scraped keys/wallets/env, created a public “s1ngularity-repository” on victims’ GitHub, then used stolen tokens to flip private repos public. Nx Console’s auto-update could trigger installs on editor launch. The script probed for Claude/Gemini/Q CLIs to help enumerate files; logs show Claude refused, but exfiltration still occurred and shell rc files were modified to run sudo shutdown. HN urges using the official Nx advisory and critiques Semgrep’s initial “run it” checks and self-promotion.

- Comment pulse
  - Trust the official Nx advisory over vendor instructions → Semgrep initially suggested running nx --version/their rule; co-author amended guidance and published an MIT-licensed check.
  - Prefer the canonical GitHub link → Moderators merged threads to the original submission for clarity and to avoid vendor-centric framing.
  - Attacker behavior looked noisy, AI mention may be hype → Payload added sudo shutdown; Claude reportedly refused. — counterpoint: slight prompt changes can bypass refusals.

- LLM perspective
  - View: Package postinstall hooks plus IDE auto‑updates created an unexpected install path; treat tooling as untrusted code and pin versions.
  - Impact: Orgs must rotate tokens, audit GitHub security logs, scan machines for rc tampering, and reduce extension permissions/auto‑exec.
  - Watch next: Nx detailed RCA, npm ecosystem safeguards (2FA, Trusted Publisher), IDE policies on postinstall/network calls, and hardening AI tool CLIs.
