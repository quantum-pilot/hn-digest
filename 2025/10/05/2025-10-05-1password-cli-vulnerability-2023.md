# 1Password CLI Vulnerability (2023)

- Score: 109 | [HN](https://news.ycombinator.com/item?id=45478553) | Link: https://codeberg.org/manchicken/1password-cli-vuln-disclosure

- TL;DR
    - A researcher shows 1Password’s CLI leaves a broad, reusable session after a single unlock, letting any spawned process (e.g., IDE extensions, npm post-install scripts) enumerate and exfiltrate everything you can access—not just one secret. A PoC prints and exfiltrates item data in plaintext. Suggested mitigations: disable CLI integration on workstations, use service accounts, and run package managers with --ignore-scripts. HN splits between “airtight hatchway” (not a vuln) and calls for least-privilege scopes (per-vault/item, per-process prompts).

- Comment pulse
    - Need least privilege → Per-vault/item scoping; until then, use service accounts to narrow exposure.
    - Not a vuln → If malware runs as you, it can read what you can — counterpoint: CLI widens blast radius beyond the intended secret.
    - Why disclose now? → Author delayed to allow fixes and due to personal timing.

- LLM perspective
    - View: Treat op like an agent; enforce scoped, per-command tokens and per-vault/item allowlists.
    - Impact: Developers using IDE plugins and package managers; orgs with shared vaults; CI/CD hygiene.
    - Watch next: 1Password roadmap for scoped CLI ACLs, per-process prompts, session isolation; third-party wrappers enforcing allowlists.
