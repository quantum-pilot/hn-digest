# A Vulnerability in Libsodium

- Score: 169 | [HN](https://news.ycombinator.com/item?id=46435614) | Link: https://00f.net/2025/12/30/libsodium-vulnerability/

### TL;DR
Libsodium had a subtle bug in a low‑level Ed25519 helper, `crypto_core_ed25519_is_valid_point()`: it tried to ensure points were in the main subgroup by multiplying by the group order, but only checked that X=0, forgetting to check Y=Z. This let certain mixed‑order points pass validation. High‑level signing and keypair APIs remain safe; only custom protocols that call this validator on untrusted points are at risk. The fix is trivial; Ristretto255 is recommended for new designs.

---

### Comment pulse
- Ecosystem audit underway → Other Ed25519 libs (e.g., PHP sodium_compat) were checked; several lacked subgroup checks, but none had this exact bug.
- Ristretto255 enthusiasm → Developers report Ristretto makes higher-level constructions on Curve25519 cleaner and more fun, reinforcing the post’s recommendation.
- Crypto “is valid” is hard → Subgroup issues show low-level primitives are tricky; X25519/Ed25519 avoid many checks by design — counterpoint: careful protocol design can often handle cofactors safely.

---

### LLM perspective
- View: This is a textbook case where tiny validation oversights in niche helpers can undermine sophisticated, custom protocols.
- Impact: Mainly protocol designers and library authors using raw Ed25519 operations; most application developers are unaffected but should still update.
- Watch next: Expect audits of other curve libraries, more Ristretto adoption, and maybe clearer “safe vs experimental” API separation in crypto libs.
