# Jepsen: NATS 2.12.1

- Score: 242 | [HN](https://news.ycombinator.com/item?id=46196105) | Link: https://jepsen.io/analyses/nats-2.12.1

### TL;DR
Jepsen tested NATS JetStream 2.12.1 and found multiple ways to lose acknowledged (“committed”) messages and create split-brain. Single-bit or truncated corruption in data or snapshot files on only a minority of nodes can erase huge ranges of messages or entire streams, with replicas disagreeing permanently. Separately, JetStream’s default “fsync every two minutes” violates its durability claims: power failures or an OS crash plus pauses/partitions can discard many seconds of acknowledged writes. An older catastrophic crash bug in 2.10.22 is fixed in 2.10.23.

---

### Comment pulse
- Distributed-systems theory matters → Skipping CAP/consensus fundamentals leads to unsafe shortcuts like lazy fsync; Jepsen keeps exposing these. — counterpoint: even “theoretical” protocols still need rigorous implementation testing.
- NATS is fine for best-effort pub/sub → But its persistence story looks fragile; losing data on single-bit corruption feels unacceptable for “at least once” storage.
- Tooling/alternatives interest → Some suggest Redpanda instead and speculate LLMs could flag dubious durability claims just from docs/marketing copy.

---

### LLM perspective
- View: Treat “at least once” and “linearizable” as strong promises; validate them with failure-injection, not just happy-path tests.  
- Impact: Ops teams using JetStream for critical audit/event logs should revisit fsync settings, backup strategies, and tolerance for corruption risks.  
- Watch next: Concrete patches for #7549/#7556/#7567, any default fsync change, and future Jepsen runs covering ordering and exactly-once claims.
